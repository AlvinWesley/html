<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <style>
        .img-area {
            position: relative;
            width: 100%;
            height: 240px;
            background: var(--grey);
            margin-bottom: 30px;
            border-radius: 15px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .img-area img,
        .img-area iframe,
        .img-area div,
        .img-area canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            z-index: 100;
        }

        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

        :root {
            --blue: #0071FF;
            --light-blue: #B6DBF6;
            --dark-blue: #005DD1;
            --grey: #f2f2f2;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: var(--light-blue);
        }

        .container {
            max-width: 400px;
            width: 80%;
            background: #fff;
            padding: 30px;
            border-radius: 30px;
        }

        /*
        .img-area {
            position: relative;
            width: 100%;
            height: 240px;
            background: var(--grey);
            margin-bottom: 30px;
            border-radius: 15px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }*/

        .img-area .icon {
            font-size: 100px;
        }

        .img-area h3 {
            font-size: 20px;
            font-weight: 500;
            margin-bottom: 6px;
        }

        .img-area p {
            color: #999;
        }

        .img-area p span {
            font-weight: 600;
        }

        .img-area img,
        .img-area iframe,
        .img-area div {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            z-index: 100;
        }

        .img-area::before {
            content: attr(data-img);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, .5);
            color: #fff;
            font-weight: 500;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            pointer-events: none;
            opacity: 0;
            transition: all .3s ease;
            z-index: 200;
        }

        .img-area.active:hover::before {
            opacity: 1;
        }

        .select-image {
            display: block;
            width: 60%;
            padding: 16px 0;
            border-radius: 15px;
            background: var(--blue);
            color: #fff;
            font-weight: 500;
            font-size: 16px;
            border: none;
            cursor: pointer;
            transition: all .3s ease;
        }

        .select-image:hover {
            background: var(--dark-blue);
        }

        .bt-3d1k {
            display: flex;
            flex-direction: row;
            gap: 1rem;
        }

        .bt-3d1k .up-x3b2 {
            display: none;
            max-width: 300px;
            width: 60%;
            padding: 10px 0;
            border-radius: 15px;
            background: var(--blue);
            color: #fff;
            font-weight: 500;
            font-size: 16px;
            border: none;
            cursor: pointer;
            transition: all .3s ease;
        }
    </style>
</head>

<body>
    <div class="container">
        <input type="file" id="file" accept="image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt" hidden>
        <div class="img-area" data-img="">
            <i class='bx bxs-cloud-upload icon'></i>
            <h3>Upload File</h3>
            <p>File size must be less than <span>2MB</span></p>
        </div>
        <div class="bt-3d1k">
            <button class="select-image">Select File</button>
            <button id="bn-1wa" class="up-x3b2">Upload</button>
            <button id="bn-2aw" class="up-x3b2">Cancle</button>
        </div>
    </div>
    <!-- Include PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js"></script>
    <!-- Include Mammoth.js for DOCX -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
    <!-- Include PptxGenJS for PPTX -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pptxgenjs/3.6.0/pptxgen.bundle.js"></script>
    <script>
        /*
        const selectImage = document.querySelector('.select-image');
        const inputFile = document.querySelector('#file');
        const imgArea = document.querySelector('.img-area');

        selectImage.addEventListener('click', function() {
            inputFile.click();
        });

        inputFile.addEventListener('change', function() {
            const file = this.files[0];
            if (file.size < 5000000) {
                const reader = new FileReader();
                reader.onload = () => {
                    const allImg = imgArea.querySelectorAll('img, iframe, div, canvas');
                    allImg.forEach(item => item.remove());
                    const fileUrl = reader.result;
                    const fileType = file.type;

                    if (fileType.startsWith('image/')) {
                        const img = document.createElement('img');
                        img.src = fileUrl;
                        imgArea.appendChild(img);
                    } else if (fileType === 'application/pdf') {
                        renderPDF(fileUrl);
                    } else if (fileType === 'text/plain') {
                        const iframe = document.createElement('iframe');
                        iframe.src = 'data:text/html,' + encodeURIComponent('<pre>' + reader.result + '</pre>');
                        imgArea.appendChild(iframe);
                    } else if (fileType === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document') {
                        renderDOCX(fileUrl);
                    } else if (fileType === 'application/vnd.openxmlformats-officedocument.presentationml.presentation') {
                        renderPPTX(file);
                    } else {
                        alert('File type not supported for preview.');
                    }

                    imgArea.classList.add('active');
                    imgArea.dataset.img = file.name;
                };
                reader.readAsDataURL(file);
            } else {
                alert("File size more than 2MB");
            }
        });

        // Set the workerSrc for PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

        function renderPDF(fileUrl) {
            const loadingTask = pdfjsLib.getDocument(fileUrl);
            loadingTask.promise.then(pdf => {
                pdf.getPage(1).then(page => {
                    const viewport = page.getViewport({ scale: .47 });
                    const canvas = document.createElement('canvas');
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;
                    const context = canvas.getContext('2d');

                    const renderContext = {
                        canvasContext: context,
                        viewport: viewport
                    };
                    page.render(renderContext).promise.then(() => {
                        imgArea.appendChild(canvas);
                    });
                });
            });
        }

        function renderDOCX(fileUrl) {
            fetch(fileUrl)
                .then(response => response.arrayBuffer())
                .then(buffer => mammoth.convertToHtml({ arrayBuffer: buffer }))
                .then(result => {
                    const div = document.createElement('div');
                    div.innerHTML = result.value;
                    imgArea.appendChild(div);
                })
                .catch(console.error);
        }

        function renderPPTX(file) {
            const reader = new FileReader();
            reader.onload = (event) => {
                const arrayBuffer = event.target.result;
                PptxGenJS.load(arrayBuffer, function(pptx) {
                    const slide = pptx.slides[0]; // Preview the first slide
                    slide.getThumbnail({ type: 'base64', mime: 'image/png' }, function(thumbnail) {
                        const img = document.createElement('img');
                        img.src = 'data:image/png;base64,' + thumbnail;
                        imgArea.appendChild(img);
                    });
                });
            };
            reader.readAsArrayBuffer(file);
        }*/


        /*

        const selectImage = document.querySelector('.select-image');
        const inputFile = document.querySelector('#file');
        const imgArea = document.querySelector('.img-area');
        let isFilePreviewedFlag = false; // Flag to track if a file is being previewed

        selectImage.addEventListener('click', function() {
            inputFile.click();
        });

        inputFile.addEventListener('change', function() {
            const file = this.files[0];
            if (file.size < 5000000) {
                const reader = new FileReader();
                reader.onload = () => {
                    clearPreview();
                    const fileUrl = reader.result;
                    const fileType = file.type;

                    if (fileType.startsWith('image/')) {
                        const img = document.createElement('img');
                        img.src = fileUrl;
                        imgArea.appendChild(img);
                    } else if (fileType === 'application/pdf') {
                        renderPDF(fileUrl);
                    } else if (fileType === 'text/plain') {
                        const iframe = document.createElement('iframe');
                        iframe.style.width = '100%';
                        iframe.style.height = '100%';
                        iframe.src = 'data:text/html,' + encodeURIComponent('<pre>' + reader.result + '</pre>');
                        imgArea.appendChild(iframe);
                    } else if (fileType === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document') {
                        renderDOCX(fileUrl);
                    } else if (fileType === 'application/vnd.openxmlformats-officedocument.presentationml.presentation') {
                        renderPPTX(file);
                    } else {
                        alert('File type not supported for preview.');
                    }

                    isFilePreviewedFlag = true; // Set the flag to true
                    imgArea.dataset.img = file.name;
                };
                reader.readAsDataURL(file);
            } else {
                alert("File size more than 2MB");
            }
        });

        // Function to clear the preview area
        function clearPreview() {
            const allElements = imgArea.querySelectorAll('img, iframe, div, canvas');
            allElements.forEach(item => item.remove());
            isFilePreviewedFlag = false; // Reset the flag when clearing the preview
        }

        // Set the workerSrc for PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

        function renderPDF(fileUrl) {
            const loadingTask = pdfjsLib.getDocument(fileUrl);
            loadingTask.promise.then(pdf => {
                pdf.getPage(1).then(page => {
                    const viewport = page.getViewport({ scale: 1 });
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');

                    // Set canvas dimensions to match the container
                    canvas.style.width = '100%';
                    canvas.style.height = '100%';
                    const scale = Math.min(
                        imgArea.clientWidth / viewport.width,
                        imgArea.clientHeight / viewport.height
                    );
                    const scaledViewport = page.getViewport({ scale });

                    canvas.height = scaledViewport.height;
                    canvas.width = scaledViewport.width;

                    const renderContext = {
                        canvasContext: context,
                        viewport: scaledViewport
                    };
                    page.render(renderContext).promise.then(() => {
                        imgArea.appendChild(canvas);
                    });
                });
            });
        }

        function renderDOCX(fileUrl) {
            fetch(fileUrl)
                .then(response => response.arrayBuffer())
                .then(buffer => mammoth.convertToHtml({ arrayBuffer: buffer }))
                .then(result => {
                    const div = document.createElement('div');
                    div.style.width = '100%';
                    div.style.height = '100%';
                    div.style.overflow = 'auto';
                    div.innerHTML = result.value;
                    imgArea.appendChild(div);
                })
                .catch(console.error);
        }

        function renderPPTX(file) {
            const reader = new FileReader();
            reader.onload = (event) => {
                const arrayBuffer = event.target.result;
                PptxGenJS.load(arrayBuffer, function(pptx) {
                    const slide = pptx.slides[0]; // Preview the first slide
                    slide.getThumbnail({ type: 'base64', mime: 'image/png' }, function(thumbnail) {
                        const img = document.createElement('img');
                        img.src = 'data:image/png;base64,' + thumbnail;
                        img.style.width = '100%';
                        img.style.height = '100%';
                        imgArea.appendChild(img);
                    });
                });
            };
            reader.readAsArrayBuffer(file);
        }

        // Function to check if a file is currently previewed
        function isFilePreviewed() {
            return isFilePreviewedFlag;
        }

        // Example usage of the isFilePreviewed function
        selectImage.addEventListener('click', function() {
            if (isFilePreviewed()) {
                console.log('A file is currently being previewed.');
            } else {
                console.log('No file is currently being previewed.');
            }
        });*/
    </script>
</body>

</html>